{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/brandontsang/projects/slate/src/components/dashboard/ContentManagerSubject.tsx\";\nimport { motion, useDragControls } from 'framer-motion';\nimport { useContext, useEffect, useLayoutEffect, useReducer, useRef } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport styles from './ContentManagerSubject.module.scss';\nimport ContentManagerSubjectContent from './ContentManagerSubjectContent';\nimport { ContentManagerContext } from '../../contexts/contentManager';\nimport { getLastElement } from '../../misc/util';\nexport default function ContentManagerSubject({\n  subject,\n  isReordering,\n  startReorder,\n  updateYPositions\n}) {\n  const {\n    user,\n    fns: {\n      addObject,\n      removeObject\n    }\n  } = useContext(ContentManagerContext);\n  const {\n    0: isOpen,\n    1: toggleIsOpen\n  } = useReducer(state => !state, false);\n  const dragControls = useDragControls();\n  const subjectEl = useRef(null);\n  const reorderButton = useRef(null);\n  useEffect(() => {\n    subjectEl.current.style.setProperty('--accent-color', `#${subject.color}`);\n  }, []);\n  if (updateYPositions) useLayoutEffect(updateYPositions);\n  useEffect(() => {\n    updateYPositions(true);\n  }, [isOpen]);\n\n  function addFolder(parentUuid, after) {\n    addObject({\n      uuid: uuidv4(),\n      type: 'folder',\n      name: uuidv4(),\n      children: []\n    }, parentUuid, after);\n  }\n\n  function addArticle(parentUuid, after) {\n    addObject({\n      uuid: uuidv4(),\n      type: 'article',\n      name: uuidv4(),\n      author: user.name.toLowerCase(),\n      content: '',\n      children: []\n    }, parentUuid, after);\n  }\n\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    layoutId: subject.uuid,\n    transition: {\n      ease: 'easeInOut',\n      duration: isReordering ? 0.2 : 0\n    },\n    drag: \"y\",\n    dragControls: dragControls,\n    onDragStart: (evt, info) => {\n      // Prevent dragging unless event target is reorder button\n      // https://github.com/framer/motion/issues/363#issuecomment-621355442\n      if (evt.target !== reorderButton.current) {\n        dragControls.componentControls.forEach(entry => {\n          entry.stop(evt, info);\n        });\n        return;\n      }\n\n      if (startReorder) {\n        if (isOpen) toggleIsOpen();\n        startReorder(evt, subject);\n      }\n    },\n    className: styles.subject,\n    ref: subjectEl,\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: toggleIsOpen,\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: `material-icons-sharp ${styles['subject--expand-button']} ${isOpen ? styles.open : ''}`,\n        children: \"chevron_right\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: styles.info,\n      style: {\n        color: `#${subject.color}`\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: styles['info--title'],\n        style: {\n          background: `#${subject.color}`\n        },\n        children: subject.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          width: '0.5rem',\n          display: 'inline-block'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }, this), subject.description]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"material-icons-sharp\",\n        children: \"create\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"material-icons-sharp\",\n        onClick: () => removeObject(subject, subject.parent),\n        children: \"delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"material-icons-sharp\",\n      style: {\n        cursor: 'ns-resize',\n        margin: '0px -2px'\n      },\n      ref: reorderButton,\n      children: \"drag_indicator\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${styles.expansion} ${isOpen ? '' : styles.collapsed}`,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles['add-content'],\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: styles['add-content--button'],\n          style: {\n            marginRight: '0.5rem'\n          },\n          onClick: () => {\n            addFolder(subject.uuid, getLastElement(subject.children) || '0');\n          },\n          children: \"add folder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: styles['add-content--button'],\n          onClick: () => {\n            addArticle(subject.uuid, subject.children[subject.children.length - 1] || '0');\n          },\n          children: \"add article\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.children,\n        children: /*#__PURE__*/_jsxDEV(ContentManagerSubjectContent, {\n          content: subject.children,\n          isOpen: isOpen\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 9\n  }, this);\n}","map":{"version":3,"sources":["/Users/brandontsang/projects/slate/src/components/dashboard/ContentManagerSubject.tsx"],"names":["motion","useDragControls","useContext","useEffect","useLayoutEffect","useReducer","useRef","v4","uuidv4","styles","ContentManagerSubjectContent","ContentManagerContext","getLastElement","ContentManagerSubject","subject","isReordering","startReorder","updateYPositions","user","fns","addObject","removeObject","isOpen","toggleIsOpen","state","dragControls","subjectEl","reorderButton","current","style","setProperty","color","addFolder","parentUuid","after","uuid","type","name","children","addArticle","author","toLowerCase","content","ease","duration","evt","info","target","componentControls","forEach","entry","stop","open","background","width","display","description","parent","cursor","margin","expansion","collapsed","marginRight","length"],"mappings":"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","sourcesContent":["import {motion, useDragControls} from 'framer-motion';\nimport {\n    useContext,\n    useEffect,\n    useLayoutEffect,\n    useReducer,\n    useRef\n} from 'react';\nimport {v4 as uuidv4} from 'uuid';\n\nimport styles from './ContentManagerSubject.module.scss';\nimport ContentManagerSubjectContent from './ContentManagerSubjectContent';\nimport {ContentManagerContext} from '../../contexts/contentManager';\nimport {Content, Subject} from '../../defs/content';\nimport {getLastElement} from '../../misc/util';\n\nexport default function ContentManagerSubject({\n    subject,\n    isReordering,\n    startReorder,\n    updateYPositions\n}: {\n    subject: Subject;\n    isReordering: boolean;\n    startReorder?: (evt: MouseEvent, object: Content) => void;\n    updateYPositions?: (force?: boolean) => void;\n}) {\n    const {\n        user,\n        fns: {addObject, removeObject}\n    } = useContext(ContentManagerContext);\n\n    const [isOpen, toggleIsOpen] = useReducer((state) => !state, false);\n    const dragControls = useDragControls();\n    const subjectEl = useRef(null);\n    const reorderButton = useRef(null);\n\n    useEffect(() => {\n        subjectEl.current.style.setProperty(\n            '--accent-color',\n            `#${subject.color}`\n        );\n    }, []);\n    if (updateYPositions) useLayoutEffect(updateYPositions);\n\n    useEffect(() => {\n        updateYPositions(true);\n    }, [isOpen]);\n\n    function addFolder(parentUuid: string, after: string) {\n        addObject(\n            {\n                uuid: uuidv4(),\n                type: 'folder',\n                name: uuidv4(),\n                children: []\n            },\n            parentUuid,\n            after\n        );\n    }\n\n    function addArticle(parentUuid: string, after: string) {\n        addObject(\n            {\n                uuid: uuidv4(),\n                type: 'article',\n                name: uuidv4(),\n                author: user.name.toLowerCase(),\n                content: '',\n                children: []\n            },\n            parentUuid,\n            after\n        );\n    }\n\n    return (\n        <motion.div\n            layoutId={subject.uuid}\n            transition={{ease: 'easeInOut', duration: isReordering ? 0.2 : 0}}\n            drag=\"y\"\n            dragControls={dragControls}\n            onDragStart={(evt, info) => {\n                // Prevent dragging unless event target is reorder button\n                // https://github.com/framer/motion/issues/363#issuecomment-621355442\n                if (evt.target !== reorderButton.current) {\n                    (dragControls as any).componentControls.forEach(\n                        (entry: any) => {\n                            entry.stop(evt, info);\n                        }\n                    );\n                    return;\n                }\n\n                if (startReorder) {\n                    if (isOpen) toggleIsOpen();\n                    startReorder(evt as MouseEvent, subject);\n                }\n            }}\n            className={styles.subject}\n            ref={subjectEl}\n        >\n            <button onClick={toggleIsOpen}>\n                <span\n                    className={`material-icons-sharp ${\n                        styles['subject--expand-button']\n                    } ${isOpen ? styles.open : ''}`}\n                >\n                    chevron_right\n                </span>\n            </button>\n            <p\n                className={styles.info}\n                style={{\n                    color: `#${subject.color}`\n                }}\n            >\n                <span\n                    className={styles['info--title']}\n                    style={{\n                        background: `#${subject.color}`\n                    }}\n                >\n                    {subject.name}\n                </span>\n                <span\n                    style={{\n                        width: '0.5rem',\n                        display: 'inline-block'\n                    }}\n                />\n                {subject.description}\n            </p>\n            <button>\n                <span className=\"material-icons-sharp\">create</span>\n            </button>\n            <button>\n                <span\n                    className=\"material-icons-sharp\"\n                    onClick={() => removeObject(subject, subject.parent)}\n                >\n                    delete\n                </span>\n            </button>\n            <span\n                className=\"material-icons-sharp\"\n                style={{cursor: 'ns-resize', margin: '0px -2px'}}\n                ref={reorderButton}\n            >\n                drag_indicator\n            </span>\n            <div\n                className={`${styles.expansion} ${\n                    isOpen ? '' : styles.collapsed\n                }`}\n            >\n                <div className={styles['add-content']}>\n                    <button\n                        className={styles['add-content--button']}\n                        style={{marginRight: '0.5rem'}}\n                        onClick={() => {\n                            addFolder(\n                                subject.uuid,\n                                getLastElement(subject.children) || '0'\n                            );\n                        }}\n                    >\n                        add folder\n                    </button>\n                    <button\n                        className={styles['add-content--button']}\n                        onClick={() => {\n                            addArticle(\n                                subject.uuid,\n                                subject.children[subject.children.length - 1] ||\n                                    '0'\n                            );\n                        }}\n                    >\n                        add article\n                    </button>\n                </div>\n                <div className={styles.children}>\n                    <ContentManagerSubjectContent\n                        content={subject.children}\n                        isOpen={isOpen}\n                    />\n                </div>\n            </div>\n        </motion.div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}