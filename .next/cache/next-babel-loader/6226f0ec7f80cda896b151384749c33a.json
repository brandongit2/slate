{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/brandontsang/projects/slate/src/components/dashboard/ContentManager.tsx\",\n    _s = $RefreshSig$();\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport { AnimateSharedLayout } from 'framer-motion';\nimport { useContext, useEffect, useRef } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport styles from './ContentManager.module.scss';\nimport ContentManagerSubject from './ContentManagerSubject';\nimport { ContentManagerContext } from '../../contexts/contentManager';\nimport { convertRemToPixels } from '../../misc/util';\nimport useReorder from '../../hooks/reorder';\nvar elementPositions = [];\nexport default function ContentManager() {\n  _s();\n\n  var _this = this;\n\n  var _useContext = useContext(ContentManagerContext),\n      loadedContent = _useContext.loadedContent,\n      addObject = _useContext.fns.addObject;\n\n  var elRef = useRef(null);\n\n  function updateYPositions() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    if ((!elRef.current || isReordering) && !force) return;\n    elementPositions = [];\n\n    var _iterator = _createForOfIteratorHelper(elRef.current.childNodes),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var child = _step.value;\n        var boundingBox = child.getBoundingClientRect();\n        elementPositions.push(boundingBox.top, boundingBox.bottom);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    elementPositions.pop();\n    elementPositions.sort();\n\n    if (elementPositions.length === 0) {\n      elementPositions = [-100];\n      return;\n    }\n\n    var temp = [elementPositions[0] - 0.5 * convertRemToPixels(1)];\n\n    for (var i = 1; i < elementPositions.length - 1; i += 2) {\n      temp.push((elementPositions[i] + elementPositions[i + 1]) / 2);\n    }\n\n    temp.push(elementPositions[elementPositions.length - 1] + 0.5 * convertRemToPixels(1));\n    elementPositions = temp.slice(1, temp.length - 1);\n  }\n\n  useEffect(updateYPositions, []);\n\n  var _useReorder = useReorder(elementPositions),\n      startReorder = _useReorder.startReorder,\n      isReordering = _useReorder.isReordering;\n\n  function addSubject() {\n    addObject({\n      uuid: uuidv4(),\n      type: 'subject',\n      name: uuidv4(),\n      description: 'test',\n      color: 'ffffff',\n      children: []\n    }, root.uuid, root.children[root.children.length - 1] || '0');\n  }\n\n  var root = loadedContent.find(function (_ref) {\n    var type = _ref.type;\n    return type === 'root';\n  });\n  return /*#__PURE__*/_jsxDEV(AnimateSharedLayout, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles['content-manager'],\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"content management\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'contents'\n        },\n        ref: elRef,\n        children: root.children.map(function (uuid) {\n          return /*#__PURE__*/_jsxDEV(ContentManagerSubject, {\n            subject: loadedContent.find(function (_ref2) {\n              var testUuid = _ref2.uuid;\n              return testUuid === uuid;\n            }),\n            isReordering: isReordering,\n            updateYPositions: updateYPositions,\n            startReorder: startReorder\n          }, uuid, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 25\n          }, _this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: styles['add-subject'],\n        onClick: addSubject,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-icons-sharp\",\n          children: \"add\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            justifySelf: 'start'\n          },\n          children: \"add a new subject\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: '3rem'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ContentManager, \"Z5hJpSFtqeZCGVjuF23dTcfktEM=\", false, function () {\n  return [useReorder];\n});\n\n_c = ContentManager;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContentManager\");","map":{"version":3,"sources":["/Users/brandontsang/projects/slate/src/components/dashboard/ContentManager.tsx"],"names":["AnimateSharedLayout","useContext","useEffect","useRef","v4","uuidv4","styles","ContentManagerSubject","ContentManagerContext","convertRemToPixels","useReorder","elementPositions","ContentManager","loadedContent","addObject","fns","elRef","updateYPositions","force","current","isReordering","childNodes","child","boundingBox","getBoundingClientRect","push","top","bottom","pop","sort","length","temp","i","slice","startReorder","addSubject","uuid","type","name","description","color","children","root","find","display","map","testUuid","justifySelf","height"],"mappings":"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","sourcesContent":["import {AnimateSharedLayout} from 'framer-motion';\nimport {useContext, useEffect, useRef} from 'react';\nimport {v4 as uuidv4} from 'uuid';\n\nimport styles from './ContentManager.module.scss';\nimport ContentManagerSubject from './ContentManagerSubject';\nimport {ContentManagerContext} from '../../contexts/contentManager';\nimport {Content, Root, Subject} from '../../defs/content';\nimport {convertRemToPixels} from '../../misc/util';\nimport useReorder from '../../hooks/reorder';\n\nlet elementPositions = [] as number[];\n\nexport default function ContentManager() {\n    const {\n        loadedContent,\n        fns: {addObject}\n    } = useContext(ContentManagerContext);\n\n    const elRef = useRef(null);\n\n    function updateYPositions(force = false) {\n        if ((!elRef.current || isReordering) && !force) return;\n\n        elementPositions = [];\n        for (let child of elRef.current.childNodes) {\n            let boundingBox = child.getBoundingClientRect();\n            elementPositions.push(boundingBox.top, boundingBox.bottom);\n        }\n        elementPositions.pop();\n        elementPositions.sort();\n\n        if (elementPositions.length === 0) {\n            elementPositions = [-100];\n            return;\n        }\n\n        let temp = [\n            elementPositions[0] - 0.5 * convertRemToPixels(1)\n        ] as number[];\n        for (let i = 1; i < elementPositions.length - 1; i += 2) {\n            temp.push((elementPositions[i] + elementPositions[i + 1]) / 2);\n        }\n        temp.push(\n            elementPositions[elementPositions.length - 1] +\n                0.5 * convertRemToPixels(1)\n        );\n        elementPositions = temp.slice(1, temp.length - 1);\n    }\n    useEffect(updateYPositions, []);\n\n    const {startReorder, isReordering} = useReorder(elementPositions);\n\n    function addSubject() {\n        addObject(\n            {\n                uuid: uuidv4(),\n                type: 'subject',\n                name: uuidv4(),\n                description: 'test',\n                color: 'ffffff',\n                children: []\n            },\n            root.uuid,\n            root.children[root.children.length - 1] || '0'\n        );\n    }\n\n    let root = loadedContent.find(({type}) => type === 'root') as Root;\n\n    return (\n        <AnimateSharedLayout>\n            <div className={styles['content-manager']}>\n                <h1>content management</h1>\n                <div style={{display: 'contents'}} ref={elRef}>\n                    {root.children.map((uuid) => (\n                        <ContentManagerSubject\n                            key={uuid}\n                            subject={\n                                loadedContent.find(\n                                    ({uuid: testUuid}) => testUuid === uuid\n                                ) as Subject\n                            }\n                            isReordering={isReordering}\n                            updateYPositions={updateYPositions}\n                            startReorder={startReorder}\n                        />\n                    ))}\n                </div>\n                <button className={styles['add-subject']} onClick={addSubject}>\n                    <span className=\"material-icons-sharp\">add</span>\n                    <p style={{justifySelf: 'start'}}>add a new subject</p>\n                </button>\n                <div style={{height: '3rem'}} />\n            </div>\n        </AnimateSharedLayout>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}